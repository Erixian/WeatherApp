<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Previsão do Tempo</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background-color: #f4f4f9; }
        .container { max-width: 600px; margin: auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        input { width: 100%; padding: 8px; box-sizing: border-box; border: 1px solid #ccc; border-radius: 4px; }
        button { background-color: #007bff; color: white; padding: 10px 15px; border: none; border-radius: 4px; cursor: pointer; }
        .result-box { margin-top: 20px; border-top: 2px solid #eee; padding-top: 20px; }
        .data-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .section-title { grid-column: span 2; background: #eee; padding: 5px; margin-top: 10px; font-weight: bold; }
    </style>
</head>
<body>

<div class="container">
    <h2>Buscar Clima</h2>

    <!-- Formulário de Entrada -->
    <form th:action="@{/weather}" method="get">
        <div class="form-group">
            <label>Cidade:</label>
            <input type="text" name="city" placeholder="Ex: Zocca" required>
        </div>
        <div class="form-group">
            <label>Código do Estado (BR use UF):</label>
            <input type="text" name="stateCode" th:value="${stateCode != null ? stateCode : ''}" placeholder="Ex: SP">
        </div>
        <div class="form-group">
            <label>Código do País:</label>
            <input type="text" name="countryCode" placeholder="Ex: IT">
        </div>
        <button type="submit">Consultar</button>
    </form>

    <!-- Exibição dos Resultados (Só aparece se weatherData não for nulo) -->
    <div class="result-box" th:if="${weatherData != null}">
        <h3>Resultado para: <span th:text="${coords.name}">Cidade</span>, <span th:text="${weatherData.sys.country}">País</span></h3>

        <div class="data-grid">
            <!-- Coordenadas -->
            <div class="section-title">Localização</div>
            <div>Latitude: <span th:text="${coords.lat}"></span></div>
            <div>Longitude: <span th:text="${coords.lon}"></span></div>

            <!-- Clima (Weather List) -->
            <div class="section-title">Condições Atuais</div>
            <div th:each="w : ${weatherData.weather}" style="grid-column: span 2;">
                <img th:src="@{'http://openweathermap.org/img/wn/' + ${w.icon} + '.png'}" alt="Weather Icon">
                <span th:text="${w.main}">Main</span> - <span th:text="${w.description}">Description</span>
            </div>

            <!-- Main Data -->
            <div class="section-title">Temperaturas e Umidade</div>
            <div>Temp. Atual: <span th:text="${weatherData.main.temp}"></span>°</div>
            <div>Sensação: <span th:text="${weatherData.main.feelsLike}"></span>°</div>
            <div>Mínima: <span th:text="${weatherData.main.tempMin}"></span>°</div>
            <div>Máxima: <span th:text="${weatherData.main.tempMax}"></span>°</div>
            <div>Umidade: <span th:text="${weatherData.main.humidity}"></span>%</div>
            <div>Pressão: <span th:text="${weatherData.main.pressure}"></span> hPa</div>

            <!-- Rain & Clouds -->
            <div class="section-title">Precipitação e Nuvens</div>
            <div>Chuva (1h): <span th:text="${weatherData.rain != null ? weatherData.rain.lh : '0'}">0</span> mm</div>
            <div>Nuvens: <span th:text="${weatherData.clouds.all}"></span>%</div>

            <!-- Sys & Misc -->
            <div class="section-title">Sistema e Horários (Unix)</div>
            <div>Nascer do Sol: <span th:text="${weatherData.sys.sunrise}"></span></div>
            <div>Pôr do Sol: <span th:text="${weatherData.sys.sunset}"></span></div>
            <div>Timezone: <span th:text="${weatherData.timezone}"></span></div>
            <div>ID Cidade: <span th:text="${weatherData.id}"></span></div>
            <div>Status HTTP: <span th:text="${weatherData.cod}"></span></div>
        </div>
    </div>
</div>

</body>
</html>